{% extends "mfa/totp/base.html" %}
{% load allauth %}
{% load django_bootstrap5 %}
{% block title %}
    Activate Authenticator App
{% endblock title %}
{% block content %}
    <div class="container">
        <h1>Activate Authenticator App</h1>
        <p>To protect your account with two-factor authentication, scan the QR code below with your authenticator app. Then, input the verification code generated by the app below.</p>
        {% url 'mfa_activate_totp' as action_url %}
        {% element form form=form method="post" action=action_url %}
            {% slot body %}
                <img src="{{totp_svg_data_uri}}" class="img-thumbnail" alt="{{form.secret}}">
                {% csrf_token %}
                <div class="mb-3">
                    <label for="{{authenticator_secret}}" class="form-label">Authenticator secret</label>
                    <input id="{{authenticator_secret}}" class="form-control" type="text" value="{{form.secret}}" aria-label="authenticatorSecretHelpBlock" disabled readonly>
                    <div id="authenticatorSecretHelpBlock" class="form-text">
                        You can store this secret and use it to reinstall your authenticator app at a later time.
                    </div>
                </div>
                {% bootstrap_form form %}
            {% endslot %}
            {% slot actions %}
                <button type="submit" class="btn btn-primary">Activate</button>
            {% endslot %}
        {% endelement %}
    </div>
{% endblock content %}